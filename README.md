Code from the book Practical SQL 2 by Anthony DeBarros
